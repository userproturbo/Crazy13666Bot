require("dotenv").config();

const { Telegraf } = require('telegraf');

const bot = new Telegraf(process.env.BOT_TOKEN);

// –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
bot.on('new_chat_members', (ctx) => {
  const name = ctx.message.new_chat_members[0].first_name;
  ctx.reply(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${name}! –ù–∞–¥–µ—é—Å—å, —Ç—ã –≥–æ—Ç–æ–≤ –∫ –º–µ–º–∞–º, –¥—Ä–æ–Ω–∞–º –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º üòé`);
});

// –†–µ–∞–∫—Ü–∏—è –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
bot.hears(/–¥—Ä–æ–Ω/i, (ctx) => {
  ctx.reply("–î—Ä–æ–Ω? –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ! –ñ–¥—ë–º –≤–∏–¥–µ–æ –ø–æ–ª—ë—Ç–æ–≤ üöÅüî•");
});

bot.hears(/–ø—É—Ç–µ—à–µ—Å—Ç–≤/i, (ctx) => {
  ctx.reply("–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è ‚Äî —ç—Ç–æ –∂–∏–∑–Ω—å! –ö—É–¥–∞ –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ—à—å—Å—è? üåç");
});

bot.hears(/–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç|–ò–ò/i, (ctx) => {
  ctx.reply("–ò–ò —É–∂–µ –∑–¥–µ—Å—å. –Ø —Å–ª–µ–∂—É –∑–∞ –≤–∞–º–∏, –ª—é–¥–∏... ü§ñüëÅÔ∏è");
});

// –õ—ë–≥–∫–∏–π —Ç—Ä–æ–ª–ª–∏–Ω–≥
bot.on('text', (ctx) => {
  const msg = ctx.message.text.toLowerCase();

  // –ù–µ–º–Ω–æ–≥–æ –ø—Ä–∏–∫–æ–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  const jokes = [
    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –º–Ω–µ–Ω–∏–µ‚Ä¶ –Ω–æ —è –≤—Å—ë —Ä–∞–≤–Ω–æ —É–º–Ω–µ–µ üòè",
    "–°–∏–ª—å–Ω–æ–µ –∑–∞—è–≤–ª–µ–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ –±—É–¥–µ–º üòÇ",
    "–ó–∞–ø–∏—Å–∞–ª —ç—Ç–æ –≤ –∞–Ω–Ω–∞–ª—ã –≤–µ–ª–∏–∫–æ–π –º—É–¥—Ä–æ—Å—Ç–∏ –Ω–∞—à–µ–π –≥—Ä—É–ø–ø—ã üìö",
    "–•–º–º‚Ä¶ —Å–ø–æ—Ä–Ω–æ ü§® –Ω–æ –ª–∞–¥–Ω–æ",
    "–ê —ç—Ç–æ –º—ã—Å–ª—å! –ò–ª–∏ –Ω–µ—Ç‚Ä¶ —è –µ—â—ë –¥—É–º–∞—é ü§î"
  ];

  // –° 10% —à–∞–Ω—Å–æ–º –±–æ—Ç —à—É—Ç–æ—á–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç
  if (Math.random() < 0.10) {
    const joke = jokes[Math.floor(Math.random() * jokes.length)];
    ctx.reply(joke);
  }
});

// –ö–æ–º–∞–Ω–¥–∞ /start (–µ—Å–ª–∏ –ø–∏—Å–∞—Ç—å –≤ –õ–°)
bot.start((ctx) => ctx.reply("–Ø –±–æ—Ç –≤–∞—à–µ–π –≥—Ä—É–ø–ø—ã! –î–æ–±–∞–≤—å—Ç–µ –º–µ–Ω—è –≤ —á–∞—Ç –∏ —Å–¥–µ–ª–∞–π—Ç–µ –∞–¥–º–∏–Ω–æ–º üõ†"));

// –ó–∞–ø—É—Å–∫
bot.launch();
console.log("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω ü§ñ");
